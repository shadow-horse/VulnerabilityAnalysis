## SaltStack远程命令执行(CVE-2020-11651、CVE-2020-11652) 

### 1. 漏洞描述 

SaltStack是基于Python开发的一套C/S架构配置管理工具，是一个服务器基础架构集中化管理平台，具备配置管理、远程执行、监控等功能，基于Python语言实现，结合轻量级消息队列（ZeroMQ）与Python第三方模块（Pyzmq、PyCrypto、Pyjinjia2、python-msgpack和PyYAML等）构建。
 
通过部署SaltStack，运维人员可以在成千万台服务器上做到批量执行命令，根据不同业务进行配置集中化管理、分发文件、采集服务器数据、操作系统基础及软件包管理等，SaltStack是运维人员提高工作效率、规范业务配置与操作的利器。
 
近日，国外某安全团队披露了SaltStack存在认证绕过漏洞（CVE-2020-11651）和目录遍历漏洞（CVE-2020-11652）。
 
在CVE-2020-11651认证绕过漏洞中，攻击者通过构造恶意请求，可以绕过Salt Master的验证逻辑，调用相关未授权函数功能，从而可以造成远程命令执行漏洞。在CVE-2020-11652目录遍历漏洞中，攻击者通过构造恶意请求，读取服务器上任意文件。

### 2. 影响版本

SaltStack < 2019.2.4  
SaltStack < 3000.2

### 3. 影响版本

SaltStack < 2019.2.4  
SaltStack < 3000.2

### 4. 漏洞验证 

1. 建议直接通过Docker镜像，启动salt-master：

	docker pull vulfocus/saltstack-cve_2020_11651:latest
	docker images
	docker run -d -p 4505:4505 -p 4506:4506 ID
	
2. 下载POC脚本    
	https://github.com/jasperla/CVE-2020-11651-poc
	
		python3 exploit.py --master 本机IP地址  //运行报错，安装先关依赖
		python2 exploit.py --master 192.168.115.130 -r /etc/shadow  
		



参考链接：https://zhuanlan.zhihu.com/p/138545035 