## Nginx CVE-2018-16843/16844/16845拒绝服务漏洞

### 简介
 
　　“在nginxHTTP/2实现中发现了两个安全问题，这可能导致过多的内存消耗（CVE-2018-16843）和CPU使用率（CVE-2018-16844），”详见nginx的安全建议。
 
　　此外，“如果在配置文件中使用”listen“指令的”http2“选项，则问题会影响使用ngx_http_v2_module编译的nginx（默认情况下不编译）。”
 
　　为了利用上述两个问题，攻击者可以发送特制的HTTP/2请求，这将导致过多的CPU使用和内存使用，最终触发DoS状态。
　　第三个安全问题（CVE-2018-16845）影响MP4模块，允许攻击者在恶意制作的MP4文件的帮助下，在工作进程中导致无限循环，崩溃或内存泄露状态。
 
　　最后一个安全问题仅影响运行使用ngx_http_mp4_module构建的nginx版本并在配置文件中启用mp4选项的服务器。此外，如果攻击者还设法触发恶意MP4文件的处理，则该问题仅会影响服务器。
 
　　虽然HTTP/2漏洞影响1.9.5和1.15.5之间的所有nginx版本，但MP4模块安全问题会影响运行nginx1.0.7及更高版本的服务器以及nginx1.1.3或更高版本。
 
　　为缓解这两个问题，服务器管理员必须将其nginx安装更新为1.14.1稳定版或1.15.6主线版本。

	ngx_http_v2_module模块默认不编译，除非--with-http_v2_module指定配置参数，并且在.conf文件中配置：
	listen 443 ssl http2;  

	ngx_http_mp4_module模块默认也不编译，除非--with-http_mp4_module指定配置参数。该攻击需要攻击上传恶意的MP4文件
	
	
目前大部分网站均是HTTP1.1的，并且关于http2的利用poc未发现，影响比较有限。  
MP4文件导致的拒绝服务，需要Nginx开启mp4模块，支持流媒体播放，且攻击者上传恶意的MP4文件进行攻击，可通过WAF监控MP4文件的上传。 
	
### http2协议检查

通过Chrom浏览器的开发者工具可以检查请求的协议版本
查询相关的域名  
<img src="https://github.com/shadow-horse/Learning-resource/blob/master/VulnerabilityAnalysis/Nginx/CVE-2018-16843%2644%2645/img/searchwebsite.png" />
<img src="https://github.com/shadow-horse/Learning-resource/blob/master/VulnerabilityAnalysis/Nginx/CVE-2018-16843%2644%2645/img/vivo.com.cn.png">
<img src="https://github.com/shadow-horse/Learning-resource/blob/master/VulnerabilityAnalysis/Nginx/CVE-2018-16843%2644%2645/img/vivo.com.cn.about.png"/>

<img src="https://github.com/shadow-horse/Learning-resource/blob/master/VulnerabilityAnalysis/Nginx/CVE-2018-16843%2644%2645/img/dev.vivo.com.cn.png">
<img src="https://github.com/shadow-horse/Learning-resource/blob/master/VulnerabilityAnalysis/Nginx/CVE-2018-16843%2644%2645/img/bbs.vivo.com.cn.png/>

<img src="https://github.com/shadow-horse/Learning-resource/blob/master/VulnerabilityAnalysis/Nginx/CVE-2018-16843%2644%2645/img/developer.vivo.com.cn.png">
<img src="https://github.com/shadow-horse/Learning-resource/blob/master/VulnerabilityAnalysis/Nginx/CVE-2018-16843%2644%2645/img/game.vivo.com.cn.png"/>

<img src="https://github.com/shadow-horse/Learning-resource/blob/master/VulnerabilityAnalysis/Nginx/CVE-2018-16843%2644%2645/img/stweb.gamecenter.com.cn.png">

<img src="https://github.com/shadow-horse/Learning-resource/blob/master/VulnerabilityAnalysis/Nginx/CVE-2018-16843%2644%2645/img/info.appstore.vivo.com.cn.png">
<img src="https://github.com/shadow-horse/Learning-resource/blob/master/VulnerabilityAnalysis/Nginx/CVE-2018-16843%2644%2645/img/zs.vivo.vom.vn.png"/>




